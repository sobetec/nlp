<!DOCTYPE html>
<html lang="ko">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>NLP -News List</title>
    <link rel="stylesheet" href="css/auto-ml.css">
    <!-- <link rel="stylesheet" type="text/css" href="datatables/datatables.css"> -->
    <link rel="stylesheet" type="text/css" href="css/jquery.dataTables.min.css">
    <link rel="stylesheet" href="css/w3.css">
    <link rel="stylesheet" href="css/pagination.css">
    <style>
        #example_report,
        #example_news,
        #example,
        #industry_news_list {
            text-align: center;
            font-size: 11px;
        }


        .hiihihihiihidden {
            display: block;
        }


        /* The Modal (background) */
        .modal {
            display: none;
            /* Hidden by default */
            position: fixed;
            /* Stay in place */
            z-index: 1;
            /* Sit on top */
            left: 0;
            top: 0;
            width: 100%;
            /* Full width */
            height: 100%;
            /* Full height */
            overflow: auto;
            /* Enable scroll if needed */
            background-color: rgb(0, 0, 0);
            /* Fallback color */
            background-color: rgba(0, 0, 0, 0.4);
            /* Black w/ opacity */
        }

        /* Modal Content/Box */
        .modal-content {
            background-color: #fefefe;
            margin: -7% auto;
            /* 15% from the top and centered */
            padding-top: 20px;
            padding-bottom: 20px;
            padding-left: 40px;
            padding-right: 40px;
            width: 72%;
            /* Could be more or less, depending on screen size */
            min-height: 300px;
            position: relative;
            vertical-align: middle;
        }

        .modal-title {
            margin: 7% auto;
            /* 15% from the top and centered */
            min-height: 40px;
            background-color: #0508b1;
            text-align: center;
            vertical-align: middle;
            position: relative;
            padding: 20px;
            width: 72%;
            /* Could be more or less, depending on screen size */
        }

        .modal-close {
            background-color: #fefefe;
            margin: 7% auto;
            padding-top: 20px;
            padding-bottom: 20px;
            padding-left: 40px;
            padding-right: 40px;
            width: 72%;
            min-height: 50px;
            position: relative;
            vertical-align: middle;
        }

        .modal-loading {
            background-color: #fefefe;
            margin: 10% auto;
            /* 15% from the top and centered */
            padding: 40px;
            border: 1px solid #888;
            width: 70%;
            /* Could be more or less, depending on screen size */
            min-height: 400px;
            position: relative;
        }


        * {
            box-sizing: border-box;
            scrollbar-color: transparent transparent;
            /* thumb and track color */
            scrollbar-width: 0px;
        }

        *::-webkit-scrollbar {
            width: 0;
        }

        *::-webkit-scrollbar-track {
            background: transparent;
        }

        *::-webkit-scrollbar-thumb {
            background: transparent;
            border: none;
        }

        * {
            -ms-overflow-style: none;
        }

        .carousel {
            position: relative;
            /*margin-top: 12%;*/
            filter: drop-shadow(0 0 10px #0003);
            perspective: 100px;
            background-color: rgb(199, 190, 108);
        }

        .carousel::before,
        .carousel::after,
        .carousel__prev,
        .carousel__next {
            position: absolute;
            top: 0;
            margin-top: 1.2%;
            width: 2rem;
            height: 2rem;
            transform: translateY(-50%);
            border-radius: 50%;
            font-size: 0;
            outline: 0;
        }

        .carousel::before,
        .carousel__prev {
            left: 1rem;
        }

        .carousel::after,
        .carousel__next {
            right: 1rem;
        }

        .carousel::before {
            content: '';
            z-index: 1;
            /*background-color: #333;*/
            background-color: rgb(49, 156, 22);
            background-size: 1rem 1rem;
            background-repeat: no-repeat;
            background-position: center center;
            color: #fff;
            font-size: 1rem;
            line-height: 2rem;
            text-align: center;
            pointer-events: none;
        }

        .carousel::after {
            content: '';
            z-index: 1;
            background-color: rgb(141, 29, 29);
            background-size: 1rem 1rem;
            background-repeat: no-repeat;
            background-position: center center;
            color: #fff;
            font-size: 2rem;
            line-height: 3rem;
            text-align: center;
            pointer-events: none;
        }

        .carousel::before {
            background-image: url("img/left-arrow.png");
        }

        .carousel::after {
            background-image: url("img/right-arrow.png");
        }

        .carouselNoPrev {
            position: relative;
            perspective: 100px;
        }

        .carouselNoPrev::before,
        .carouselNoPrev::after,
        .carouselNoPrev__prev,
        .carouselNoPrev__next {
            position: absolute;
            top: 0;
            margin-top: 1.2%;
            width: 2rem;
            height: 2rem;
            transform: translateY(-50%);
            border-radius: 50%;
            font-size: 0;
            outline: 0;
        }

        .carouselNoPrev::before,
        .carouselNoPrev__prev {
            left: 1rem;
        }

        .carouselNoPrev::after,
        .carouselNoPrev__next {
            right: 1rem;
        }

        .carouselNoPrev::before {
            opacity: 0;
            content: '';
            z-index: 1;
            background-color: rgb(168, 199, 54);
            background-size: 1rem 1rem;
            background-repeat: no-repeat;
            background-position: center center;
            color: #fff;
            font-size: 1rem;
            line-height: 2rem;
            text-align: center;
            pointer-events: none;
        }

        .carouselNoPrev::after {
            content: '';
            z-index: 1;
            background-color: rgb(173, 48, 167);
            background-size: 1rem 1rem;
            background-repeat: no-repeat;
            background-position: center center;
            color: #fff;
            font-size: 2rem;
            line-height: 3rem;
            text-align: center;
            pointer-events: none;
        }


        .carouselNoPrev::before {
            /*background-image: url("img/left-arrow.png");*/
        }

        .carouselNoPrev::after {
            background-image: url("img/right-arrow.png");
        }


        .carouselNoNext {
            position: relative;
            perspective: 100px;
        }

        .carouselNoNext::before,
        .carouselNoNext::after,
        .carouselNoNext__prev,
        .carouselNoNext__next {
            position: absolute;
            top: 0;
            margin-top: 1.2%;
            width: 2rem;
            height: 2rem;
            transform: translateY(-50%);
            border-radius: 50%;
            font-size: 0;
            outline: 0;
        }

        .carouselNoNext::before,
        .carouselNoNext__prev {
            left: 1rem;
        }

        .carouselNoNext::after,
        .carouselNoNext__next {
            right: 1rem;
        }

        .carouselNoNext::before {
            content: '';
            z-index: 1;
            background-color: rgb(40, 185, 178);
            background-size: 1rem 1rem;
            background-repeat: no-repeat;
            background-position: center center;
            color: #fff;
            font-size: 1rem;
            line-height: 2rem;
            text-align: center;
            pointer-events: none;
        }

        .carouselNoNext::after {
            opacity: 0;
            content: '';
            z-index: 1;
            background-color: rgb(255, 255, 255);
            background-size: 1rem 1rem;
            background-repeat: no-repeat;
            background-position: center center;
            color: #fff;
            font-size: 2rem;
            line-height: 3rem;
            text-align: center;
            pointer-events: none;
        }


        .carouselNoNext::before {
            background-image: url("img/left-arrow.png");
        }

        .carouselNoNext::after {
            /*background-image: url("img/right-arrow.png");*/
        }



        /* fold */
        .menu a {
            cursor: pointer;
        }

        .fold a {
            cursor: pointer;
        }

        .menu .hide li:hover {

            text-decoration: underline;
            cursor: pointer;
            font-size: 14px;
            font-weight: bolder;
            color: #7c130c;
        }

        .menu .hide {
            display: none;
            font-size: 14px;

        }



        .visivi {
            visibility: visible;
            font-size: 13px;
            font-weight: bold;
            position: absolute;
            color: #0d1775;
        }

        .closed {
            visibility: hidden;
            font-size: 13px;
            font-weight: bold;
            position: relative;
            color: #090b88;
        }

        .list li:hover {
            text-decoration: underline;
            cursor: pointer;
            font-size: 14px;
            font-weight: bolder;
            color: #7c130c;
        }

        .list li {

            font-size: 14px;

        }

        .nulls {
            display: none;
        }
    </style>

    <script type="text/javascript" src="js/jquery-3.5.1.js"></script>
    <script type="text/javascript" charset="utf8" src="datatables/datatables.js"></script>
    <script type="text/javascript" src="js/pagination.js"></script>
    <script>

        $(document).ready(function () {
            createEmptyDatatable();
            $('#example_news').DataTable();
            $('#example_report').DataTable();
            setDisplay();
            $('#date_picker_div_News').hide();
            $('#condition').hide();
            $('#condition_report').hide();


            //페이지 소스 총길이

            var pageLength = 55;
            var sources = function () {
                var result = [];
          
                for (var i = 1; i <= pageLength; i++) {
                  result.push(i);
                }
          
                return result;
              }();

            $('#pagination-container').pagination({
                dataSource: sources,
                pageSize: 1,
                pageRange: 1,
                showGoInput: true,
                showGoButton: true,
                showNavigator: true,
                callback: function (pagination) {
                    //    //     var html = _.template($('#template-demo').html(), {
                    //    //         data: data
                    //    //     });
                    //    //$('#data-container').html(html);
                    var industry_name = "경 인쇄업";
                    console.log(industry_name);
                    getNewsListByIndustry(industry_name);
                }
            });

        });




        function viewNewsContents(i) {
            console.log(window.newsResponseData[i]);
            console.log(window.newsResponseData[i].indexNum);
            console.log(window.newsResponseData.length);

            var prev = ``;
            var next = ``;
            var j = -1;
            var k = -1;
            var carouselOption = "";

            if (i != 0 && i != window.newsResponseData.length - 1) {
                j = i - 1;
                k = i + 1;
                prev = `<a href="javascript:viewNewsContents(` + j + `);" class="carousel__prev">Go to last slide</a>`;
                next = `<a href="javascript:viewNewsContents(` + k + `);" class="carousel__next">Go to next slide</a>`;
                carouselOption = "carousel";
            }
            else if (i == 0) {
                k = i + 1;
                prev = ``;
                next = `<a href="javascript:viewNewsContents(` + k + `);" class="carousel__next">Go to next slide</a>`;
                carouselOption = "carouselNoPrev";
            }
            else if (i == window.newsResponseData.length - 1) {
                j = i - 1;
                prev = `<a href="javascript:viewNewsContents(` + j + `);" class="carousel__prev">Go to last slide</a>`;
                next = ``;
                carouselOption = "carouselNoNext";
            }

            var sectionHtml =
                `   
            <section class="` + carouselOption + `" aria-label="Gallery" style="background-color: #FFF;">
                <div class="carousel__snapper">
                    ` + prev + next + `
                </div>
            </section>  
        `;



            var modalhtml =
                `   
            <div class="modal-title">
                ` + sectionHtml + `
                <p style="text-align: center; vertical-align: middle;"><b><span style="font-size: 13pt; color:white; vertical-align: middle;">` + window.newsResponseData[i].newsTtl + `</span></b></p>
            </div>

            <div class="modal-content">

                <section>
                    <div>
                        <table style="width:100%;">
                            <tr>
                                <td>
                                    

                                    <p style="text-align: right; line-height: 1;"><br />` + window.newsResponseData[i].newsDate + `</p>

                                    <div style="border: 1px solid #888;">
                                        <p style="text-align: center; line-height: 1.5;"><br />` + window.newsResponseData[i].rawData + `</p>
                                    </div>

                                    <p><br/></p>
                                    <p><br/></p>
                                    <p><br></p>
                                    <p><br></p>


                                </td>
                            </tr>
                        </table>
                    </div>
                </section>

                <div>
                </div>
                
            </div>
            


            <div class="modal-close">
                <table style="width:100%;">
                    <tr>
                        <td>
                            <div style="cursor:pointer;background-color:#DDDDDD;text-align: center;padding-bottom: 10px; padding-top: 10px; position:absolute; bottom:10px; width:85%; left:50%; transform:translate(-50%, 0);" onClick="close_pop();">
                                <span class="pop_bt" style="font-size: 13pt;" >
                                    닫기
                                </span>
                            </div>
                        </td>
                    </tr>
                </table>
            </div>


            
        `;
            document.getElementById('myModal').innerHTML = modalhtml;
            $('#myModal').show();
        }


        function loading1(loading) {
            var modalhtml1 =
                `
        <div class="modal-loading">
            <p style="text-align: center;"><span style="font-size: 14pt;"><b><span style="font-size: 24pt;">` + loading + ` 목록 불러오는 중...</span></b></span></p>
            <button type="button" class="close" onClick="close_pop();"></button>
            <p style="text-align: center; line-height: 1.5;"><br />데이터 베이스에서 읽어오고 있습니다.</p>
            <p style="text-align: center; line-height: 1.5;"><br />잠시만 기다려 주십시오.</p>
            <p><br /></p>
            <p style="text-align: center; line-height: 1.5;"><br />
                <img src="/img/loading.gif" align="center"/>
            </p>
        </div>
        `;
            document.getElementById('myModal').innerHTML = modalhtml1;
            $('#myModal').show();

        }



        function drawTable(result_area, table_id) {

            var htmlStart =
                `
        <table id="`+ table_id + `" class="display" style="width:100%">
                    <colgroup>
                        <col>
                    </colgroup>
                    <thead>
                    <tr>
                        <th>인덱스</th>
						<th>컴포짓키</th>
						<th>날짜</th>
						<th>기업명</th>
						<th>제목</th>
						<th>progress</th>
						<th>스코어</th>
                    </tr>
                    </thead>
                    <tbody id="`+ result_area + `">
        `;

            for (var i = 0; i < window.newsResponseData.length; i++) {
                var indexNum = i + 1;
                window.newsResponseData[i].indexNum = indexNum;
                var sscoreWord = newsResponseData[i].taScreWord;
                var sscore = 0;

                if (newsResponseData[i].taScre != NaN) {
                    tempSscore = Math.round(newsResponseData[i].taScre).toString();;
                    if (tempSscore.match(/^[0-9]$/) != null) {
                        sscore = '0' + tempSscore;
                    } else {
                        sscore = tempSscore;
                    }
                    //console.log(sscore);
                };


                var rred = '';
                var procc = '';

                if (sscoreWord == '중립') {
                    procc = `<td><div style="width:100%; border:0.5px solid grey; height:7px; color:#000!important; background-color:#dadada!important; border-radius:6px" >
				<div style="height:7px; padding:0.01em; width:`+ sscore + `%; color: #fff!important;
				background-color: #32880a!important; border-radius: 7px; font-size: 0%;" >`+ sscore + `</div>
			</div></td>`
                    rred = `<td style='color:#32880a;'>` + sscoreWord + `</td>`;
                } else if (sscoreWord == '부정') {
                    procc = `<td><div style="width:100%; border:0.5px solid grey; height:7px; color:#000!important; background-color:#dadada!important; border-radius:6px" >
				<div style="height:7px; padding:0.01em; width:`+ sscore + `%; color: #fff!important;
				background-color: #2196F3!important; border-radius: 7px; font-size: 0%;" >`+ sscore + `</div>
			</div></td>`
                    rred = `<td style='color:#2196F3;'>` + sscoreWord + `</td>`;
                } else if (sscoreWord == '긍정') {
                    procc = `<td><div style="width:100%; border:0.5px solid grey; height:7px; color:#000!important; background-color:#dadada!important; border-radius:6px" >
				<div style="height:7px; padding:0.01em; width:`+ sscore + `%; color: #fff!important;
				background-color: #a31b1b!important; border-radius: 7px; font-size: 0%;" >`+ sscore + `</div>
			</div></td>`
                    rred = `<td style='color:#a31b1b;'>` + sscoreWord + `</td>`;
                } else if (sscoreWord == '없음') {
                    procc = `<td>no score</td>`
                    rred = `<td style='color:black'>` + sscoreWord + `</td>`;
                }


                var htmlContents =
                    `
                <tr>
                    <td>` + indexNum + `</td>
                    <td>` + window.newsResponseData[i].cmpyKey + `</td>
                    <td>` + window.newsResponseData[i].newsDate + `</td>
                    <td>` + window.newsResponseData[i].cmpyName + `</td>
                    <td><a href="javascript:viewNewsContents(` + i + `);">` + window.newsResponseData[i].newsTtl + `</a></td>
                    `+ procc + `
                    `+ rred + `
                </tr>
            `;
                htmlStart = htmlStart + htmlContents;
            }

            var htmlEnd =
                `
            </tbody>
        </table>
        `;

            document.getElementById(result_area).innerHTML = htmlStart + htmlEnd;

            $('#' + table_id).DataTable();
            close_pop();
        }


        function drawTableReport() {
            var htmlStart =
                `
        <table id="example_report" class="display" style="width:100%">
                    <colgroup>
                        <col>
                    </colgroup>
                    <thead>
                    <tr>
                        <th>인덱스</th>
                        <th>날짜</th>
                        <th>제목</th>
                        <th>progress</th>
                        <th>스코어</th>
                        <th>타입</th>
                        <th>　</th>
                    </tr>
                    </thead>
                    <tbody id="result_area">
        `;

            for (var i = 0; i < window.reportResponseData.length; i++) {
                var indexNum = i + 1;
                window.reportResponseData[i].indexNum = indexNum;
                var sscoreWord = reportResponseData[i].taScreWord;
                var sscore = 0;

                if (reportResponseData[i].taScre != NaN) {
                    tempSscore = Math.round(reportResponseData[i].taScre).toString();;
                    if (tempSscore.match(/^[0-9]$/) != null) {
                        sscore = '0' + tempSscore;
                    } else {
                        sscore = tempSscore;
                    }
                    console.log(sscore);
                };


                var rred = '';
                var procc = '';

                if (sscoreWord == '중립') {
                    procc = `<td><div style="width:100%; border:0.5px solid grey; height:7px; color:#000!important; background-color:#dadada!important; border-radius:6px" >
                <div style="height:7px; padding:0.01em; width:`+ sscore + `%; color: #fff!important;
                background-color: #32880a!important; border-radius: 7px; font-size: 0%;" >`+ sscore + `</div>
            </div></td>`
                    rred = `<td style='color:#32880a;'>` + sscoreWord + `</td>`;
                } else if (sscoreWord == '부정') {
                    procc = `<td><div style="width:100%; border:0.5px solid grey; height:7px; color:#000!important; background-color:#dadada!important; border-radius:6px" >
                <div style="height:7px; padding:0.01em; width:`+ sscore + `%; color: #fff!important;
                background-color: #2196F3!important; border-radius: 7px; font-size: 0%;" >`+ sscore + `</div>
            </div></td>`
                    rred = `<td style='color:#2196F3;'>` + sscoreWord + `</td>`;
                } else if (sscoreWord == '긍정') {
                    procc = `<td><div style="width:100%; border:0.5px solid grey; height:7px; color:#000!important; background-color:#dadada!important; border-radius:6px" >
                <div style="height:7px; padding:0.01em; width:`+ sscore + `%; color: #fff!important;
                background-color: #a31b1b!important; border-radius: 7px; font-size: 0%;" >`+ sscore + `</div>
            </div></td>`
                    rred = `<td style='color:#a31b1b;'>` + sscoreWord + `</td>`;
                } else if (sscoreWord == '없음') {
                    procc = `<td>no score</td>`
                    rred = `<td style='color:black'>` + sscoreWord + `</td>`;
                }

                var downImg = '';

                if (window.reportResponseData[i].docCaty == 'pdf') {
                    downImg = `<img src="/img/pdf_down.png" style="width: auto; height: 25px;">`;
                }
                else if (window.reportResponseData[i].docCaty == 'hwp') {
                    downImg = `<img src="/img/hwp_down.png" style="width: auto; height: 25px;">`;
                }
                else {
                    downImg = `<img src="/img/document_download.png" style="width: auto; height: 25px;">`;
                }

                /*
                <td>
                    <a id="documentFile" href="/data/KDB_화면설계서_v0.6.pdf" download>
                        <img src="/img/document_download.png" style="width: auto; height: 50px;">
                    </a>
                </td>
                */

                var htmlContents =
                    `
                <tr>
                    <td>` + indexNum + `</td>
                    <td>` + window.reportResponseData[i].reportDate + `</td>
                    <td>` + window.reportResponseData[i].orgnFileName + `</td>
                    `+ procc + `
                    `+ rred + `
                    <td>` + window.reportResponseData[i].docCaty + `</td>
                    <td><a id="documentFile" href="C:\\Users\\sdb\\Documents\\doc_down_test\\KDB_ddd_v0.6.pdf" download>
                        ` + downImg + `
                    </a>
                    </td>
                </tr>
            `;
                htmlStart = htmlStart + htmlContents;
            }

            var htmlEnd =
                `
            </tbody>
        </table>
        `;

            document.getElementById('result_area_report').innerHTML = htmlStart + htmlEnd;

            $('#example_report').DataTable();
            close_pop();
        }


        function getNewsList() {
            var data = new Object();

            data.newsYear = parseInt($("#newsYear").val());
            data.gubun = $("#gubunNews").val();

            if ($("#gubunNews").val() == "month") {
                var temp = $("#choicesNews").val().split("월")[0];
                console.log(temp);
                data.gubunItem = parseInt(temp);
            }
            else if ($("#gubunNews").val() == "quarter") {
                var temp = $("#choicesNews").val().split("분기")[0];
                console.log(temp);
                data.gubunItem = parseInt(temp);
            }

            data.startDate = $("#date_from_news").val();
            data.endDate = $("#date_to_news").val();
            data.searchWord = document.getElementById('search_company_news').value;

            var result_area = 'result_area_news';
            var table_id = 'example_news';
            console.log(data);

            loading1("뉴스");

            $.ajax({
                url: "/getNewsListByCondition",
                method: 'POST',
                data: data,
                dataType: 'json',
                success: function (responseData) {
                    //alert('조회 성공');
                    console.log(responseData.length);
                    window.newsResponseData = responseData;
                    console.log(window.newsResponseData[0]);

                    $('#myModal').hide();

                    var modalhtml2 =
                        `
                    <div class="modal-loading">
                        <p style="text-align: center;"><span style="font-size: 14pt;"><b><span style="font-size: 24pt;">뉴스 목록 불러오는 중...</span></b></span></p>
                        <button type="button" class="close" onClick="close_pop();"></button>
                        <p style="text-align: center; line-height: 1.5;"><br />화면에 표출중입니다.</p>
                        <p style="text-align: center; line-height: 1.5;"><br />잠시만 기다려 주십시오.</p>
                        <p><br /></p>
                        <p style="text-align: center; line-height: 1.5;"><br />
                            <img src="/img/loading.gif" align="center"/>
                        </p>
                    </div>
                `;
                    document.getElementById('myModal').innerHTML = modalhtml2;
                    $('#myModal').show();
                    setTimeout(() => drawTable(result_area, table_id), 1000);

                },
                error: function () {
                    alert('조회 실패');
                    $('#myModal').hide();
                }
            });

        }


        function getReportList() {
            var data = new Object();

            data.reportYear = parseInt($("#reportYear").val());
            data.gubun = $("#gubunReport").val();

            if ($("#gubunReport").val() == "month") {
                var temp = $("#choicesReport").val().split("월")[0];
                console.log(temp);
                data.gubunItem = parseInt(temp);
            }
            else if ($("#gubunReport").val() == "quarter") {
                var temp = $("#choicesReport").val().split("분기")[0];
                console.log(temp);
                data.gubunItem = parseInt(temp);
            }

            data.startDate = $("#date_from_report").val();
            data.endDate = $("#date_to_report").val();
            data.searchWord = document.getElementById('search_company_report').value;


            console.log(data);

            loading1("행내 보고서");

            $.ajax({
                url: "/getReportListByCondition",
                method: 'POST',
                data: data,
                dataType: 'json',
                success: function (responseData) {
                    //alert('조회 성공');
                    console.log(responseData.length);
                    window.reportResponseData = responseData;
                    console.log(window.reportResponseData[0]);

                    $('#myModal').hide();

                    var modalhtml2 =
                        `
                    <div class="modal-loading">
                        <p style="text-align: center;"><span style="font-size: 14pt;"><b><span style="font-size: 24pt;">행내 보고서 목록 불러오는 중...</span></b></span></p>
                        <button type="button" class="close" onClick="close_pop();"></button>
                        <p style="text-align: center; line-height: 1.5;"><br />화면에 표출중입니다.</p>
                        <p style="text-align: center; line-height: 1.5;"><br />잠시만 기다려 주십시오.</p>
                        <p><br /></p>
                        <p style="text-align: center; line-height: 1.5;"><br />
                            <img src="/img/loading.gif" align="center"/>
                        </p>
                    </div>
                `;
                    document.getElementById('myModal').innerHTML = modalhtml2;
                    $('#myModal').show();
                    setTimeout(() => drawTableReport(), 1000);

                },
                error: function () {
                    alert('조회 실패');
                    $('#myModal').hide();
                }
            });

        }


        var selectListData = {
            quarter: {
                name: 'quarter',
                text: ['1분기', '2분기', '3분기', '4분기'],
                value: ['q1', 'q2', 'q3', 'q4']
            },
            month: {
                name: 'month',
                text: ['1월', '2월', '3월', '4월', '5월', '6월', '7월', '8월', '9월', '10월', '11월', '12월'],
                value: ['m1', 'm2', 'm3', 'm4', 'm5', 'm6', 'm7', 'm8', 'm9', 'm10', 'm11', 'm12']
            },
            year: {
                value: 'no'
            },
            custom: {
                value: 'no'
            }
        };

        function itemChangeNews() {

            var selectItem = $("#gubunNews").val();
            console.log(selectItem);

            var changeItem;

            if (selectItem == "quarter") {
                changeItem = selectListData.quarter.text;
                document.getElementById("choicesNews").disabled = false;
                document.getElementById("newsYear").disabled = false;
                $('#date_picker_div_News').hide();
                $('#condition').show();
            }
            else if (selectItem == "month") {
                changeItem = selectListData.month.text;
                document.getElementById("choicesNews").disabled = false;
                document.getElementById("newsYear").disabled = false;
                $('#date_picker_div_News').hide();
                $('#condition').show();
            }
            else if (selectItem == "year") {
                changeItem = '';
                document.getElementById("choicesNews").disabled = true;
                document.getElementById("newsYear").disabled = false;
                $('#date_picker_div_News').hide();
                $('#condition').hide();
            }
            else if (selectItem == "custom") {
                changeItem = '';
                document.getElementById("choicesNews").disabled = true;
                document.getElementById("newsYear").disabled = true;
                $('#date_picker_div_News').show();
                $('#condition').hide();
            }


            $('#choicesNews').empty();

            for (var count = 0; count < changeItem.length; count++) {
                var option = $("<option>" + changeItem[count] + "</option>");
                $('#choicesNews').append(option);
            }
        }

        function itemChangeReport() {

            $('#date_picker_div_Report').hide();
            var selectItem = $("#gubunReport").val();
            console.log(selectItem);

            var changeItem;

            if (selectItem == "quarter") {
                changeItem = selectListData.quarter.text;
                document.getElementById("choicesReport").disabled = false;
                document.getElementById("reportYear").disabled = false;
                $('#date_picker_div_Report').hide();
                $('#condition_report').show();
            }
            else if (selectItem == "month") {
                changeItem = selectListData.month.text;
                document.getElementById("choicesReport").disabled = false;
                document.getElementById("reportYear").disabled = false;
                $('#date_picker_div_Report').hide();
                $('#condition_report').show();
            }
            else if (selectItem == "year") {
                changeItem = '';
                document.getElementById("choicesReport").disabled = true;
                document.getElementById("reportYear").disabled = false;
                $('#date_picker_div_Report').hide();
                $('#condition_report').hide();
            }
            else if (selectItem == "custom") {
                changeItem = '';
                document.getElementById("choicesReport").disabled = true;
                document.getElementById("reportYear").disabled = true;
                $('#date_picker_div_Report').show();
                $('#condition_report').hide();
            }


            $('#choicesReport').empty();

            for (var count = 0; count < changeItem.length; count++) {
                var option = $("<option>" + changeItem[count] + "</option>");
                $('#choicesReport').append(option);
            }
        }



        function setDisplay() {
            if ($('input:radio[id=news_radio]').is(':checked')) {
                document.getElementById('main_title').innerText = '뉴스 목록 조회';
                $('#contents_section_news').show();
                $('#contents_section_report').hide();
                $('#date_picker_div_News').hide();
                $('#example_news').DataTable();

            } else {
                document.getElementById('main_title').innerText = '행내 보고서 목록 조회';
                $('#contents_section_report').show();
                $('#contents_section_news').hide();
                $('#date_picker_div_Report').hide();
                $('#example_report').DataTable();
            }

        }






        //산업별 뉴스 가져오기
        function getNewsListByIndustry(industryName) {

            console.log('산업명'+industryName);
            loading1("뉴스");
            var result_area = 'result_area_industry';
            var table_id = 'industry_news_list';
            $.ajax({
                url: "/getNewsListByIndustry/" + industryName,
                method: 'GET',
                dataType: 'json',
                success: function (responseData) {
                    //alert('조회 성공');
                    console.log(responseData.length);
                    window.newsResponseData = responseData;
                    console.log(window.newsResponseData[0]);

                    $('#myModal').hide();

                    var modalhtml2 =
                        `
                    <div class="modal-loading">
                        <p style="text-align: center;"><span style="font-size: 14pt;"><b><span style="font-size: 24pt;">뉴스 목록 불러오는 중...</span></b></span></p>
                        <button type="button" class="close" onClick="close_pop();"></button>
                        <p style="text-align: center; line-height: 1.5;"><br />화면에 표출중입니다.</p>
                        <p style="text-align: center; line-height: 1.5;"><br />잠시만 기다려 주십시오.</p>
                        <p><br /></p>
                        <p style="text-align: center; line-height: 1.5;"><br />
                            <img src="/img/loading.gif" align="center"/>
                        </p>
                    </div>
                `;
                    document.getElementById('myModal').innerHTML = modalhtml2;
                    $('#myModal').show();
                    setTimeout(() => drawTable(result_area, table_id), 1000);

                },
                error: function () {
                    alert('조회 실패');
                    $('#myModal').hide();
                }
            });

        }



        function getIndustryList() {

            industry_column_list = ["ㄱ", "ㄴ", "ㄷ", "ㄹ", "ㅁ", "ㅂ", "ㅅ", "ㅇ", "ㅈ", "ㅊ", "ㅋ", "ㅌ", "ㅍ", "ㅎ", "기타"];
            industry_column_list_java = ['responseData[i].giYeok',
                'responseData[i].niEun',
                'responseData[i].diGeut',
                'responseData[i].riEul',
                'responseData[i].miEum',
                'responseData[i].biEup',
                'responseData[i].siOt',
                'responseData[i].iEung',
                'responseData[i].jiEut',
                'responseData[i].chiEut',
                'responseData[i].kiEuk',
                'responseData[i].tiEuk',
                'responseData[i].piEup',
                'responseData[i].hiEut',
                'responseData[i].guiTar'];


            console.log(industry_column_list[0]);
            console.log(industry_column_list_java[0]);

            $.ajax({
                url: "/getIndustryList/",
                method: 'GET',
                dataType: 'json',
                success: function (responseData) {
                    // alert('조회 성공');
                    // console.log(responseData);
                    //console.log(responseData[0]);

                    //var gigi = eval(industry_column_list_java[0]);
                    //				console.log(gigi);

                    var tables = ``;

                    var expend_all = `
				<div class="buttons" align="right" >
					<a id="toggleee" class="btn" style="min-width: 110px;" href="javascript:togglee();">전체 펼치기</a>
					
				</div>
				`

                    for (var n = 0; n < 3; n++) {
                        var htmlTableHead =
                            `
                        <table style="border-style: none none none none; border-width:2px; border-color:#ccc4c3;" rules=cols>
                            <tr>
                        `;

                        var tds = ``;

                        if (n == 0) { m = 0; r = 5 };
                        if (n == 1) { m = 5; r = 10 };
                        if (n == 2) { m = 10; r = 15 };



                        for (var j = m; j < r; j++) {
                            var colName = industry_column_list[j];

                            //console.log(colJavaName);
                            var htmlhead =
                                `
                            
                                    <td style="padding-left: 16px; padding-right:10px;" valign="top" width="270">
                                        <div>
                                            <ul >
                                                <li class="menu">
                                                    <a style="font-size: large; font-weight: bold;"> `+ colName + ` </a>
                                                    
                                                    <ul class="list">
                                                        <li style="font-size: 4px;">&nbsp; </li>
                            `;

                            var htmlmiddle =
                                `
                                    </ul>
                                    <ul class="hide">
                                `;


                            k = 0;
                            for (var i = 0; i < responseData.length; i++) {
                                var colJavaName = eval(industry_column_list_java[j]);
                                // console.log('컬럼이름 '+colJavaName);
                                if (k < 5) {
                                    if (colJavaName != null) {
                                        var htmlli1 =
                                            `
                                                <li>`+ colJavaName + `</li>
                                                `;

                                        htmlhead += htmlli1;
                                        k++;
                                    }

                                } else if ((colJavaName != null)) {
                                    var htmlli2 =
                                        `
                                                <li>`+ colJavaName + `</li>
                                                `;
                                    htmlmiddle += htmlli2;
                                };
                            };


                            var htmltail =
                                `
                                                            </ul>
                                                            <a class="visivi"  > 더보기 ▼ </a>
                                                            <a class="closed"  > 접기 ▲ </a>
                                                        </li>


                                                    </ul>
                                                </div>
                                            </td>
                                                            
                                                            
                            `;
                            var td = htmlhead + htmlmiddle + htmltail;

                            tds += td;
                        };

                        var htmlTableTail =
                            `
                            </tr>
                        <br/>	
                        <br/>
                        </table>	

                    `

                        var htmltable1 = htmlTableHead + tds + htmlTableTail;

                        tables += htmltable1;
                    };


                    document.getElementById('result_area_industry').innerHTML = expend_all + tables;


                    $(".menu>a").click(function () {

                        //$('directoryresults').find('input');
                        var lisf = $(this).siblings('ul');
                        var submenu = $(lisf[1]);
                        var lista = $(this).siblings('a');
                        var folda1 = $(lista[0]);
                        var folda2 = $(lista[1]);

                        if (submenu.is(":visible")) {
                            submenu.slideUp(400);

                            if ($(this).hasClass('closed')) {
                                $(this).css('visibility', 'hidden');
                            }
                            if (folda1.hasClass('closed')) {
                                folda1.css('visibility', 'hidden');
                            }
                            if (folda2.hasClass('closed')) {
                                folda2.css('visibility', 'hidden');
                            }
                            if ($(this).hasClass('visivi')) {
                                $(this).css('visibility', 'visible');
                            }
                            if (folda1.hasClass('visivi')) {
                                folda1.css('visibility', 'visible');
                            }
                            if (folda2.hasClass('visivi')) {
                                folda2.css('visibility', 'visible');
                            }

                        } else {
                            submenu.slideDown(400);

                            if ($(this).hasClass('closed')) {
                                $(this).css('visibility', 'visible');
                            }
                            if (folda1.hasClass('closed')) {
                                folda1.css('visibility', 'visible');
                            }
                            if (folda2.hasClass('closed')) {
                                folda2.css('visibility', 'visible');
                            }
                            if ($(this).hasClass('visivi')) {
                                $(this).css('visibility', 'hidden');
                            }
                            if (folda1.hasClass('visivi')) {
                                folda1.css('visibility', 'hidden');
                            }
                            if (folda2.hasClass('visivi')) {
                                folda2.css('visibility', 'hidden');
                            }

                        }
                        console.log("im aclick in list");

                    });

                    $(".list").on("click", "li", function () {
                        alert($(this).text());
                        var industryName = $(this).text();
                        console.log(industryName);
                        getNewsListByIndustry(industryName);
                    });

                    $(".hide").on("click", "li", function () {
                        alert($(this).text());
                        var industryName = $(this).text();
                        console.log(industryName);
                        getNewsListByIndustry(industryName);
                    });

                },
                error: function () {
                    alert('조회 실패');
                }
            });



        }




        function rmv() {
            $(".hide").slideUp();
            $(".closed").css('visibility', 'hidden');
            $(".visivi").css('visibility', 'visible');
            $("#toggleee").text('전체 펼치기');

        }

        function sshow() {
            $(".hide").slideDown();
            $(".closed").css('visibility', 'visible');
            $(".visivi").css('visibility', 'hidden');
            $("#toggleee").text('전체 접기');
        }

        function togglee() {
            if ($("#toggleee").text() == '전체 펼치기') {
                sshow();
            } else if ($("#toggleee").text() == '전체 접기') {
                rmv();
            };
        }

        function dataTableSearch() {
            //$("#dataTableSearch").val('엘지');
            //$("#dataTableSearch").focus();
            //$("#dataTableSearch").bind("keydown", function(e) {
            //    if (e.keyCode == 13) { // enter key
            //       // yourAction();
            //        return false
            //	}
            //});


            //$("#dataTableSearch").trigger(e);

            $("#dataTableSearch").val('엘지');
            //$("#search_company").trigger(e);

            pressButton();
        }

        function pressButton() {
            var e = jQuery.Event("keyup.DT");
            //var e = jQuery.Event( "search.DT", { keyCode: 13 } )
            $("#dataTableSearch").trigger(e);

            //setTimeout(function () {
            //	jQuery('#search_company').trigger('click');
            // }, 1000);
            console.log('im trigger press enter')
        }



        function dataTableSearchSam() {
            $("#dataTableSearch").val('삼성');
            //$("#dataTableSearch").focus();
            //$("#dataTableSearch").bind("keydown", function(e) {
            //    if (e.keyCode == 13) { // enter key
            //       // yourAction();
            //        return false
            //	}
            //});


            //$("#dataTableSearch").trigger(e);

            //$("#search_company").val('엘지');
            //$("#search_company").trigger(e);

            pressButton();
        }


        function itemChangeFold() {

            var selectItem = $("#fold").val();
            console.log(selectItem);

            if (selectItem == "company") {
                $('#result_area_subsidiary').hide();
                $('#result_area_industry').hide();
                document.getElementById("search_company_news").disabled = false;
                document.getElementById("search_button_news").disabled = false;
                $('#result_area_news').show();

            }
            else if (selectItem == "subsidiary") {
                $('#result_area_industry').hide();
                $('#result_area_news').hide();
                document.getElementById("search_company_news").disabled = true;
                document.getElementById("search_button_news").disabled = true;
                $('#result_area_subsidiary').show();
            }
            else if (selectItem == "industry") {
                getIndustryList();
                $('#result_area_news').hide();
                $('#result_area_subsidiary').hide();
                document.getElementById("search_company_news").disabled = true;
                document.getElementById("search_button_news").disabled = true;
                $('#result_area_industry').show();
            }
        }


        function createEmptyDatatable() {
            var tableNews = ``;
            var tableReport = ``;
            for (var i = 0; i < 10; i++) {
                tableNews = tableNews + `<tr> <td>　 </td><td></td><td></td><td></td><td></td><td></td><td></td> </tr>`;
                tableReport = tableReport + `<tr> <td>　 </td><td></td><td></td><td></td><td></td><td></td> </tr>`;
            }
            document.getElementById('tbodyNews').innerHTML = tableNews;
            document.getElementById('tbodyReport').innerHTML = tableReport;
        }



    </script>




</head>

<body>
    <div class="wrap">
        <header class="header">
            <!-- logo -->
            <h1 class="logo_area">
                <a href="/" class="link_logo"><img src="img/logo_KDB.jpg" alt="algograp"></a>
            </h1>

            <div class="right_area">
                <!-- user -->
                <div class="buttons">
                    <button class="btn_shortcut"><span class="blind">바로가기</span></button>

                </div>
            </div>
        </header>

        <div class="container">

            <div class="side_panel">
                <h2 class="blind">메뉴</h2>
                <!-- menu -->
                <nav class="main_menu is_fold">
                    <ul class="menu_list">
                        <li><a href="#" class="link_menu active"><i class="icon_01"></i><span class="menu">데이터
                                    관리</span></a></li>
                        <li><a href="#" class="link_menu"><i class="icon_02"></i><span class="menu">데이터 전처리</span></a>
                        </li>
                        <li><a href="#" class="link_menu"><i class="icon_03"></i><span class="menu">데이터 분리</span></a>
                        </li>
                        <li><a href="#" class="link_menu"><i class="icon_04"></i><span class="menu">데이터 분석</span></a>
                        </li>
                        <li><a href="#" class="link_menu"><i class="icon_05"></i><span class="menu">분석 결과</span></a>
                        </li>
                        <li><a href="#" class="link_menu"><i class="icon_06"></i><span class="menu">데이터 진단</span></a>
                        </li>
                        <li><a href="#" class="link_menu"><i class="icon_07"></i><span class="menu">배포</span></a></li>
                    </ul>



                    <button class="btn_close"><span class="blind">메인메뉴 닫기</span></button>
                </nav>


            </div>


            <div class="main_panel" role="main">


                <div class="contents_panel">


                    <div class="w3-container">


                        <div
                            style="border:0.5px solid grey; height:10px; color:#000!important; background-color:#dadada!important; border-radius:6px">
                            <div style="height:9px; padding:0.01em; width:25%; color: #fff!important;
                        background-color: #2196F3!important; border-radius: 6px; font-size: 0%;">25%</div>
                        </div>
                        <br>
                        <div
                            style="border:0.5px solid grey; height:10px; color:#000!important; background-color:#dadada!important; border-radius:6px">
                            <div style="height:9px; padding:0.01em; width:80%; color: #fff!important;
                        background-color: #a31b1b!important; border-radius: 6px; font-size: 0%;">80%</div>
                        </div>

                        <br>
                        <div
                            style="border:0.5px solid grey; height:10px; color:#000!important; background-color:#dadada!important; border-radius:6px">
                            <div style="height:9px; padding:0.01em; width:50%; color: #fff!important;
                        background-color: #32880a!important; border-radius: 6px; font-size: 0%;">50%</div>
                        </div>
                    </div>




                    <h3 class="main_title" id="main_title">뉴스 목록 조회</h3>


                    <span class="input_radio" >
                        <input type="radio" class="input_radio" id="news_radio" name="news_report"
                            onchange="setDisplay()" checked="checked">
                        <label for="news_radio" class="label">뉴스</label>

                    </span>
                    <span class="input_radio" >
                        <input type="radio" class="input_radio" id="report_radio" name="news_report"
                            onchange="setDisplay()">
                        <label for="report_radio" class="label">보고서</label>
                    </span>

                
                    
                        <span class="hiihihihiihidden">
                            <span  id='pagination-container' width="400px" >


                            </span>

                        </span >
                       
                    
                
                   


                    <div class="section" id="contents_section_news">
                        <div class="option_set">


                            <div class="data_set">
                                <select class="select" id="fold" style="width:100px;" onChange="itemChangeFold()">
                                    <option value="company">기업별</option>
                                    <option value="subsidiary">계열별</option>
                                    <option value="industry">산업별</option>
                                </select>
                            </div>

                            <div class="data_set" style="float:left">
                                <a>연도 선택</a>
                                <select name="newsYear" id="newsYear" class="select"
                                    style="min-width: 80px; width:80px;">
                                    <option value="2025">2025</option>
                                    <option value="2024">2024</option>
                                    <option value="2023">2023</option>
                                    <option value="2022">2022</option>
                                    <option value="2021">2021</option>
                                    <option value="2020" selected="selected">2020</option>
                                    <option value="2019">2019</option>
                                    <option value="2018">2018</option>
                                    <option value="2017">2017</option>
                                    <option value="2016">2016</option>
                                    <option value="2015">2015</option>
                                </select>
                            </div>

                            <div class="data_set" style="float:left">
                                <a>구분</a>
                                <select name="gubun" id="gubunNews" class="select" onChange="itemChangeNews()">
                                    <option value="year" selected="selected">연도별</option>
                                    <option value="quarter">분기별</option>
                                    <option value="month">월별</option>
                                    <option value="custom">사용자 선택</option>
                                </select>
                            </div>

                            <div id="condition" class="data_set" style="float:left">
                                <a id="gubunText"></a>
                                <select name="choices" id="choicesNews" class="select">
                                </select>
                            </div>

                            <div id="date_picker_div_News">
                                <span class="date_picker">
                                    <label for="date_from" class="label">기간</label>
                                    <span class="input_date"><input type="text" class="input_text"
                                            id="date_from_news"></span>
                                    <span class="dash">-</span>
                                    <span class="input_date"><input type="text" class="input_text"
                                            id="date_to_news"></span>
                                </span>
                            </div>


                            <div class="search_box" id="search_box_news">
                                <input id="search_company_news" type="text" placeholder="검색" value=""
                                    onkeypress="if( event.keyCode == 13 ){getNewsList();}">
                                <button id="search_button_news" class="btn_search" onclick="getNewsList();"><span
                                        class="blind">검색</span></button>
                            </div>

                        </div>


                       

                        <!-- <div class="pagination" style="padding-top: 0px;">

                            <button class="btn_prev"><span>이전</span></button>
                            
                            <a href="#" class="page active">1</a>
                            <a href="#" class="page">2</a>
                            <a href="#" class="page">3</a>
                            <a href="#" class="page">4</a>
                            <a href="#" class="page">5</a>
                            <button class="btn_next"><span class="blind">다음</span></button>
                        </div> -->



                        <div id="result_area_news">

                            <table id="example_news" class="display" style="width:100%">
                                <colgroup>
                                    <col>
                                </colgroup>
                                <thead>
                                    <tr>
                                        <th>인덱스</th>
                                        <th>컴포짓키</th>
                                        <th>날짜</th>
                                        <th>기업명</th>
                                        <th>제목</th>
                                        <th>progress</th>
                                        <th>score</th>
                                    </tr>
                                </thead>
                                <tbody id="tbodyNews">


                                </tbody>
                            </table>
                        </div>

                        <div id="result_area_subsidiary">

                        </div>

                        <div id="result_area_industry">

                        </div>



                    </div>






                    <div class="section" id="contents_section_report">
                        <div class="option_set">

                            <div class="data_set" style="float:left;">
                                <a>연도 선택</a>
                                <select name="reportYear" id="reportYear" class="select"
                                    style="min-width: 80px; width:80px;">
                                    <option value="2025">2025</option>
                                    <option value="2024">2024</option>
                                    <option value="2023">2023</option>
                                    <option value="2022">2022</option>
                                    <option value="2021">2021</option>
                                    <option value="2020" selected="selected">2020</option>
                                    <option value="2019">2019</option>
                                    <option value="2018">2018</option>
                                    <option value="2017">2017</option>
                                    <option value="2016">2016</option>
                                    <option value="2015">2015</option>
                                </select>
                            </div>

                            <div class="data_set" style="float:left">
                                <a>구분</a>
                                <select name="gubun" id="gubunReport" class="select" onChange="itemChangeReport()">
                                    <option value="year" selected="selected">연도별</option>
                                    <option value="quarter">분기별</option>
                                    <option value="month">월별</option>
                                    <option value="custom">사용자 선택</option>
                                </select>
                            </div>

                            <div id="condition_report" class="data_set" style="float:left">
                                <a id="gubunText"></a>
                                <select name="choices" id="choicesReport" class="select">
                                </select>
                            </div>


                            <div id="date_picker_div_Report">
                                <span class="date_picker">
                                    <label for="date_from" class="label">기간</label>
                                    <span class="input_date"><input type="text" class="input_text"
                                            id="date_from_report"></span>
                                    <span class="dash">-</span>
                                    <span class="input_date"><input type="text" class="input_text"
                                            id="date_to_report"></span>
                                </span>
                            </div>

                            <div class="search_box" id="search_box_report">
                                <input id="search_company_report" type="text" placeholder="검색" value=""
                                    onkeypress="if( event.keyCode == 13 ){getReportList();}">
                                <button class="btn_search" onclick="getReportList();"><span
                                        class="blind">검색</span></button>
                            </div>

                        </div>

                        <!-- <div class="pagination" style="padding-top: 0px;">

                            <button class="btn_prev"><span class="blind">이전</span></button>
                          
                            <a href="#" class="page active">1</a>
                            <a href="#" class="page">2</a>
                            <a href="#" class="page">3</a>
                            <a href="#" class="page">4</a>
                            <a href="#" class="page">5</a>
                            <button class="btn_next"><span class="blind">다음</span></button>
                        </div> -->


                        <div id="result_area_report">
                            <table id="example_report" class="display" style="width:100%">
                                <colgroup>
                                    <col>
                                </colgroup>
                                <thead>
                                    <tr>
                                        <th>인덱스</th>
                                        <th>날짜</th>
                                        <th>제목</th>
                                        <th>스코어</th>
                                        <th>progress</th>
                                        <th>타입</th>
                                    </tr>
                                </thead>
                                <tbody id="tbodyReport">

                                </tbody>
                            </table>
                        </div>

                    </div>





                </div>



                <!-- modal area -->
                <div id="myModal" class="modal">
                    <!-- Modal content -->
                </div>

            </div>







        </div>
    </div>

    <!-- [D] 마크업 확인용 js, 개발시 제거하세요. -->

    <script type="text/javascript" src="js/jquery-ui.min.js"></script>
    <script type="text/javascript" src="js/ui-common.js"></script>




    <script type="text/javascript">

        function close_pop(flag) {
            $('#myModal').hide();
        };



    </script>
</body>

</html>